<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SQLite Playground</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/sql-wasm.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h2 { color: #333; }
    textarea { width: 100%; height: 150px; font-family: monospace; font-size: 14px; padding: 10px; }
    button { padding: 10px 20px; font-size: 16px; margin-top: 10px; cursor: pointer; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    th { background-color: #f2f2f2; }
    #fileInput { margin-bottom: 10px; }
  </style>
</head>
<body>
  <h2>Quiz Detektif SQL üïµÔ∏è</h2>
  <a href="javascript:void(0)" onclick="tampilkanSkema()">(Tampilkan Skema)</a>
  <a href="https://thel1012.github.io/q1a/">(Submit Jawaban)</a><br><br>
  <textarea id="sql">SELECT * FROM laporan_kriminal LIMIT 10;</textarea>
  <button id="run">Run SQL</button>
  <div id="output"></div>

  <script>
    initSqlJs({ locateFile: file => 
      `https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/${file}`
    }).then(async SQL => {
      const db = new SQL.Database();
      const sqlText = await fetch("mydata.sql").then(res => res.text());
      db.run(sqlText);
      const runBtn = document.getElementById("run");
      const output = document.getElementById("output");
      runBtn.onclick = () => {
        const queryRaw = document.getElementById("sql").value;
        const query = queryRaw.trim().toUpperCase();
        if (!query.startsWith("SELECT")) {
          output.textContent = "‚ùå Only SELECT queries are allowed.";
          return;
        }
        try {
          const results = db.exec(queryRaw);
          if (results.length === 0) {
            output.textContent = "Query executed (no results)";
          } else {
            const table = results[0];
            let html = '<table><thead><tr>' +
              table.columns.map(col => `<th>${col}</th>`).join('') +
              '</tr></thead><tbody>' +
              table.values.map(row => `<tr>${row.map(val => `<td>${val}</td>`).join('')}</tr>`).join('') +
              '</tbody></table>';
            output.innerHTML = html;
          }
        } catch (e) {
          output.textContent = "Error: " + e.message;
        }
      };
    });
  </script>
  <!-- Modal Structure -->
  <div id="modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); justify-content:center; align-items:center;">
    <div style="background:#fff; padding:20px; border-radius:8px; position:relative; max-width:90%; max-height:90%;">
      <span onclick="document.getElementById('modal').style.display='none'" style="position:absolute; top:10px; right:15px; cursor:pointer; font-weight:bold;">X</span>
      <img src="skema.jpg" alt="Skema" style="max-width:100%; max-height:80vh;" />
    </div>
  </div>
  <script>
    function tampilkanSkema(){
      document.getElementById('modal').style.display='flex';
    }
  </script>
</body>
</html>
